"use strict";var level=document.querySelector(".level"),highest=document.querySelector(".highest"),Enemy=function(e,n,t){this.x=e,this.y=n,this.z=t,this.sprite="images/enemy-bug.png"};Enemy.prototype.update=function(e){if(this.x+=this.z*e,500<=this.x&&(this.x=-100),this.x+40>player.x&&player.x+40>this.x&&this.y+40>player.y&&player.y+40>this.y){player.x=200,player.y=404;var n=!0,t=!(level.innerHTML=1),r=void 0;try{for(var a,o=allEnemies[Symbol.iterator]();!(n=(a=o.next()).done);n=!0)enemy=a.value,enemy.x=-100,enemy.z=randomNumber(100,100*level.innerHTML)}catch(e){t=!0,r=e}finally{try{!n&&o.return&&o.return()}finally{if(t)throw r}}}},Enemy.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)};var Player=function(e,n){this.x=e,this.y=n,this.sprite="images/char-boy.png"};Player.prototype.update=function(){if(player.y<=-44){level.textContent++,highest.textContent<level.textContent&&(highest.textContent=level.textContent);var e=!0,n=!1,t=void 0;try{for(var r,a=allEnemies[Symbol.iterator]();!(e=(r=a.next()).done);e=!0)enemy=r.value,enemy.x=-100,enemy.z*=randomNumber(1,level.textContent)}catch(e){n=!0,t=e}finally{try{!e&&a.return&&a.return()}finally{if(n)throw t}}player.y=404}},Player.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)},Player.prototype.handleInput=function(e){switch(e){case"left":0<player.x&&(player.x-=100);break;case"up":0<player.y&&(player.y-=90);break;case"right":player.x<365&&(player.x+=100);break;case"down":player.y<400&&(player.y+=90)}};var enemy1=new Enemy(404,60,300),enemy2=new Enemy(205,150,250),enemy3=new Enemy(503,230,200),allEnemies=[enemy1,enemy2,enemy3],player=new Player(200,404),allPlayer=[player];function randomNumber(e,n){return Math.floor(Math.random()*(n-e+1))+e}document.addEventListener("keyup",function(e){player.handleInput({37:"left",38:"up",39:"right",40:"down"}[e.keyCode])});var Engine=function(e){var t,n=e.document,r=e.window,a=n.createElement("canvas"),o=a.getContext("2d");function i(){var n,e=Date.now();n=(e-t)/1e3,allEnemies.forEach(function(e){e.update(n)}),player.update(),function(){var e,n,t=["images/water-block.png","images/stone-block.png","images/stone-block.png","images/stone-block.png","images/grass-block.png","images/grass-block.png"];for(o.clearRect(0,0,a.width,a.height),e=0;e<6;e++)for(n=0;n<5;n++)o.drawImage(Resources.get(t[e]),101*n,83*e);allEnemies.forEach(function(e){e.render()}),player.render()}(),t=e,r.requestAnimationFrame(i)}a.width=505,a.height=606,n.body.appendChild(a),Resources.load(["images/stone-block.png","images/water-block.png","images/grass-block.png","images/enemy-bug.png","images/char-boy.png"]),Resources.onReady(function(){t=Date.now(),i()}),e.ctx=o}(void 0);!function(){var t={},r=[];function n(e){if(t[e])return t[e];var n=new Image;n.onload=function(){t[e]=n,a()&&r.forEach(function(e){e()})},t[e]=!1,n.src=e}function a(){var e=!0;for(var n in t)t.hasOwnProperty(n)&&!t[n]&&(e=!1);return e}window.Resources={load:function(e){e instanceof Array?e.forEach(function(e){n(e)}):n(e)},get:function(e){return t[e]},onReady:function(e){r.push(e)},isReady:a}}();